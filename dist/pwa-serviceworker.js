/*
  Weather
  homepage: <https://github.com/vladmandic/weather>
  author: <https://github.com/vladmandic>'
*/

var l="weather",f="offline.html",c=["/favicon.ico","/weather.webmanifest","/public/offline.html"],i=!1,o={hit:0,miss:0},a=(...r)=>{let e=new Date,t=`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}`;console.log(t,"pwa",...r)};async function h(r){fetch(r).then(e=>(e.ok&&caches.open(l).then(t=>t.put(r,e)).catch(t=>a("cache update error",t)),!0)).catch(e=>(a("fetch error",e),!1))}async function u(r){return fetch(r.request)}function d(){caches.open(l).then(r=>r.addAll(c).then(()=>a("cache refresh:",c.length,"files"),e=>a("cache error",e)))}if(!i){self.addEventListener("message",e=>{a("event message:",{data:e==null?void 0:e.data,origin:e==null?void 0:e.origin})}),self.addEventListener("install",e=>{var n,s;if(!(e!=null&&e.currentTarget))return;let t=e.currentTarget;a("install",{scope:(n=t==null?void 0:t.registration)==null?void 0:n.scope,script:(s=t==null?void 0:t.serviceWorker)==null?void 0:s.scriptURL}),self.skipWaiting(),e.waitUntil(d)}),self.addEventListener("activate",e=>{var n;if(!(e!=null&&e.currentTarget))return;let t=e.currentTarget;a("activate",{state:(n=t==null?void 0:t.serviceWorker)==null?void 0:n.state}),e.waitUntil(self.clients.claim())}),self.addEventListener("fetch",e=>{let t=new URL(e.request.url);if(e.request.cache==="only-if-cached"&&e.request.mode!=="same-origin"||t.origin!==location.origin||e.request.method!=="GET"||e.request.url.includes("/api/"))return;let n=u(e);n?e.respondWith(n):a("fetch response missing")});let r=!1;self.addEventListener("controllerchange",e=>{a(`pwa: ${e.type}`),!r&&(r=!0,location.reload())}),i=!0}
//# sourceMappingURL=pwa-serviceworker.js.map
