/*
  Weather
  homepage: <https://github.com/vladmandic/weather>
  author: <https://github.com/vladmandic>'
*/

var o="weather",l="offline.html",s=["/favicon.ico","/weather.webmanifest","/public/offline.html"],c=!1,i={hit:0,miss:0},a=(...t)=>{let e=new Date,r=`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}`;console.log(r,"pwa",...t)};async function f(t){fetch(t).then(e=>(e.ok&&caches.open(o).then(r=>r.put(t,e)).catch(r=>a("cache update error",r)),!0)).catch(e=>(a("fetch error",e),!1))}async function h(t){return fetch(t.request)}function u(){caches.open(o).then(t=>t.addAll(s).then(()=>a("cache refresh:",s.length,"files"),e=>a("cache error",e)))}if(!c){self.addEventListener("message",e=>{a("event message:",{data:e?.data,origin:e?.origin})}),self.addEventListener("install",e=>{if(!e?.currentTarget)return;let r=e.currentTarget;a("install",{scope:r?.registration?.scope,script:r?.serviceWorker?.scriptURL}),self.skipWaiting(),e.waitUntil(u)}),self.addEventListener("activate",e=>{if(!e?.currentTarget)return;let r=e.currentTarget;a("activate",{state:r?.serviceWorker?.state}),e.waitUntil(self.clients.claim())}),self.addEventListener("fetch",e=>{let r=new URL(e.request.url);if(e.request.cache==="only-if-cached"&&e.request.mode!=="same-origin"||r.origin!==location.origin||e.request.method!=="GET"||e.request.url.includes("/api/"))return;let n=h(e);n?e.respondWith(n):a("fetch response missing")});let t=!1;self.addEventListener("controllerchange",e=>{a(`pwa: ${e.type}`),!t&&(t=!0,location.reload())}),c=!0}
//# sourceMappingURL=pwa-serviceworker.js.map
